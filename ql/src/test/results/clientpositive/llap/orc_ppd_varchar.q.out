PREHOOK: query: create table t (a string)
PREHOOK: type: CREATETABLE
PREHOOK: Output: database:default
PREHOOK: Output: default@t
POSTHOOK: query: create table t (a string)
POSTHOOK: type: CREATETABLE
POSTHOOK: Output: database:default
POSTHOOK: Output: default@t
PREHOOK: query: insert into t values('bee'),('xxx')
PREHOOK: type: QUERY
PREHOOK: Input: _dummy_database@_dummy_table
PREHOOK: Output: default@t
POSTHOOK: query: insert into t values('bee'),('xxx')
POSTHOOK: type: QUERY
POSTHOOK: Input: _dummy_database@_dummy_table
POSTHOOK: Output: default@t
POSTHOOK: Lineage: t.a SCRIPT []
PREHOOK: query: explain
select hash(a) as v from t where a='bee'
PREHOOK: type: QUERY
PREHOOK: Input: default@t
#### A masked pattern was here ####
POSTHOOK: query: explain
select hash(a) as v from t where a='bee'
POSTHOOK: type: QUERY
POSTHOOK: Input: default@t
#### A masked pattern was here ####
STAGE DEPENDENCIES:
  Stage-0 is a root stage

STAGE PLANS:
  Stage: Stage-0
    Fetch Operator
      limit: -1
      Processor Tree:
        TableScan
          alias: t
          filterExpr: (a = 'bee') (type: boolean)
          Filter Operator
            predicate: (a = 'bee') (type: boolean)
            Select Operator
              expressions: 97410 (type: int)
              outputColumnNames: _col0
              ListSink

PREHOOK: query: explain ast
select hash(a) as v from t where a='bee'
PREHOOK: type: QUERY
PREHOOK: Input: default@t
#### A masked pattern was here ####
POSTHOOK: query: explain ast
select hash(a) as v from t where a='bee'
POSTHOOK: type: QUERY
POSTHOOK: Input: default@t
#### A masked pattern was here ####
ABSTRACT SYNTAX TREE:
  
TOK_QUERY
   TOK_FROM
      TOK_TABREF
         TOK_TABNAME
            t
   TOK_INSERT
      TOK_DESTINATION
         TOK_DIR
            TOK_TMP_FILE
      TOK_SELECT
         TOK_SELEXPR
            TOK_FUNCTION
               hash
               TOK_TABLE_OR_COL
                  a
            v
      TOK_WHERE
         =
            TOK_TABLE_OR_COL
               a
            'bee'

PREHOOK: query: explain cbo
select hash(a) as v from t where a='bee'
PREHOOK: type: QUERY
PREHOOK: Input: default@t
#### A masked pattern was here ####
POSTHOOK: query: explain cbo
select hash(a) as v from t where a='bee'
POSTHOOK: type: QUERY
POSTHOOK: Input: default@t
#### A masked pattern was here ####
CBO PLAN:
HiveProject($f0=[CAST(97410):INTEGER])
  HiveFilter(condition=[=($0, _UTF-16LE'bee')])
    HiveTableScan(table=[[default, t]], table:alias=[t])

Warning: Shuffle Join MERGEJOIN[13][tables = [$hdt$_0, $hdt$_1]] in Stage 'Reducer 2' is a cross product
PREHOOK: query: select	t0.v,t1.v from
	(select hash(a) as v from t where a='bee') as t0
join	(select hash(a) as v from t where a='bee' or a='xbee') as t1 on (true)
PREHOOK: type: QUERY
PREHOOK: Input: default@t
#### A masked pattern was here ####
POSTHOOK: query: select	t0.v,t1.v from
	(select hash(a) as v from t where a='bee') as t0
join	(select hash(a) as v from t where a='bee' or a='xbee') as t1 on (true)
POSTHOOK: type: QUERY
POSTHOOK: Input: default@t
#### A masked pattern was here ####
97410	97410
