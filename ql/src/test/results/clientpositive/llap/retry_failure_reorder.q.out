PREHOOK: query: create table s (x int)
PREHOOK: type: CREATETABLE
PREHOOK: Output: database:default
PREHOOK: Output: default@s
POSTHOOK: query: create table s (x int)
POSTHOOK: type: CREATETABLE
POSTHOOK: Output: database:default
POSTHOOK: Output: default@s
PREHOOK: query: insert into s values (1),(2),(3),(4),(5),(6),(7),(8),(9),(10)
PREHOOK: type: QUERY
PREHOOK: Input: _dummy_database@_dummy_table
PREHOOK: Output: default@s
POSTHOOK: query: insert into s values (1),(2),(3),(4),(5),(6),(7),(8),(9),(10)
POSTHOOK: type: QUERY
POSTHOOK: Input: _dummy_database@_dummy_table
POSTHOOK: Output: default@s
POSTHOOK: Lineage: s.x SCRIPT []
PREHOOK: query: create table tu(id_uv int,id_uw int,u int)
PREHOOK: type: CREATETABLE
PREHOOK: Output: database:default
PREHOOK: Output: default@tu
POSTHOOK: query: create table tu(id_uv int,id_uw int,u int)
POSTHOOK: type: CREATETABLE
POSTHOOK: Output: database:default
POSTHOOK: Output: default@tu
PREHOOK: query: create table tv(id_uv int,v int)
PREHOOK: type: CREATETABLE
PREHOOK: Output: database:default
PREHOOK: Output: default@tv
POSTHOOK: query: create table tv(id_uv int,v int)
POSTHOOK: type: CREATETABLE
POSTHOOK: Output: database:default
POSTHOOK: Output: default@tv
PREHOOK: query: create table tw(id_uw int,w int)
PREHOOK: type: CREATETABLE
PREHOOK: Output: database:default
PREHOOK: Output: default@tw
POSTHOOK: query: create table tw(id_uw int,w int)
POSTHOOK: type: CREATETABLE
POSTHOOK: Output: database:default
POSTHOOK: Output: default@tw
PREHOOK: query: from s
insert overwrite table tu
        select x,x,x
        where x<=6 or x=10
insert overwrite table tv
        select x,x
        where x<=3 or x=10
insert overwrite table tw
        select x,x
PREHOOK: type: QUERY
PREHOOK: Input: default@s
PREHOOK: Output: default@tu
PREHOOK: Output: default@tv
PREHOOK: Output: default@tw
POSTHOOK: query: from s
insert overwrite table tu
        select x,x,x
        where x<=6 or x=10
insert overwrite table tv
        select x,x
        where x<=3 or x=10
insert overwrite table tw
        select x,x
POSTHOOK: type: QUERY
POSTHOOK: Input: default@s
POSTHOOK: Output: default@tu
POSTHOOK: Output: default@tv
POSTHOOK: Output: default@tw
POSTHOOK: Lineage: tu.id_uv SIMPLE [(s)s.FieldSchema(name:x, type:int, comment:null), ]
POSTHOOK: Lineage: tu.id_uw SIMPLE [(s)s.FieldSchema(name:x, type:int, comment:null), ]
POSTHOOK: Lineage: tu.u SIMPLE [(s)s.FieldSchema(name:x, type:int, comment:null), ]
POSTHOOK: Lineage: tv.id_uv SIMPLE [(s)s.FieldSchema(name:x, type:int, comment:null), ]
POSTHOOK: Lineage: tv.v SIMPLE [(s)s.FieldSchema(name:x, type:int, comment:null), ]
POSTHOOK: Lineage: tw.id_uw SIMPLE [(s)s.FieldSchema(name:x, type:int, comment:null), ]
POSTHOOK: Lineage: tw.w SIMPLE [(s)s.FieldSchema(name:x, type:int, comment:null), ]
PREHOOK: query: select (1 > sum(u*v*w)) from tu
        join tv on (tu.id_uv=tv.id_uv)
        join tw on (tu.id_uw=tw.id_uw)
        where w>9 and u>1 and v>3
PREHOOK: type: QUERY
PREHOOK: Input: default@tu
PREHOOK: Input: default@tv
PREHOOK: Input: default@tw
#### A masked pattern was here ####
POSTHOOK: query: select (1 > sum(u*v*w)) from tu
        join tv on (tu.id_uv=tv.id_uv)
        join tw on (tu.id_uw=tw.id_uw)
        where w>9 and u>1 and v>3
POSTHOOK: type: QUERY
POSTHOOK: Input: default@tu
POSTHOOK: Input: default@tv
POSTHOOK: Input: default@tw
#### A masked pattern was here ####
false
PREHOOK: query: explain
select (1 > sum(u*v*w)) from tu
        join tv on (tu.id_uv=tv.id_uv)
        join tw on (tu.id_uw=tw.id_uw)
        where w>9 and u>1 and v>3
PREHOOK: type: QUERY
POSTHOOK: query: explain
select (1 > sum(u*v*w)) from tu
        join tv on (tu.id_uv=tv.id_uv)
        join tw on (tu.id_uw=tw.id_uw)
        where w>9 and u>1 and v>3
POSTHOOK: type: QUERY
Plan optimized by CBO.

Vertex dependency in root stage
Reducer 2 <- Map 1 (SIMPLE_EDGE), Map 5 (SIMPLE_EDGE)
Reducer 3 <- Map 6 (SIMPLE_EDGE), Reducer 2 (SIMPLE_EDGE)
Reducer 4 <- Reducer 3 (CUSTOM_SIMPLE_EDGE)

Stage-0
  Fetch Operator
    limit:-1
    Stage-1
      Reducer 4 llap
      File Output Operator [FS_21]
        Select Operator [SEL_20] (rows=1 width=4)
          Output:["_col0"]
          Group By Operator [GBY_19] (rows=1 width=8)
            Output:["_col0"],aggregations:["sum(VALUE._col0)"]
          <-Reducer 3 [CUSTOM_SIMPLE_EDGE] llap
            PARTITION_ONLY_SHUFFLE [RS_18]
              Group By Operator [GBY_17] (rows=1 width=8)
                Output:["_col0"],aggregations:["sum(_col0)"]
                Select Operator [SEL_15] (rows=1 width=12)
                  Output:["_col0"]
                  Merge Join Operator [MERGEJOIN_31] (rows=1 width=12)
                    Conds:RS_12._col1=RS_13._col0(Inner),Output:["_col2","_col4","_col6"]
                  <-Map 6 [SIMPLE_EDGE] llap
                    SHUFFLE [RS_13]
                      PartitionCols:_col0
                      Select Operator [SEL_8] (rows=3 width=8)
                        Output:["_col0","_col1"]
                        Filter Operator [FIL_29] (rows=3 width=8)
                          predicate:((w > 9) and id_uw is not null)
                          TableScan [TS_6] (rows=10 width=8)
                            default@tw,tw,Tbl:COMPLETE,Col:COMPLETE,Output:["id_uw","w"]
                  <-Reducer 2 [SIMPLE_EDGE] llap
                    SHUFFLE [RS_12]
                      PartitionCols:_col1
                      Merge Join Operator [MERGEJOIN_30] (rows=1 width=12)
                        Conds:RS_9._col0=RS_10._col0(Inner),Output:["_col1","_col2","_col4"]
                      <-Map 1 [SIMPLE_EDGE] llap
                        SHUFFLE [RS_9]
                          PartitionCols:_col0
                          Select Operator [SEL_2] (rows=7 width=12)
                            Output:["_col0","_col1","_col2"]
                            Filter Operator [FIL_27] (rows=7 width=12)
                              predicate:((u > 1) and id_uv is not null and id_uw is not null)
                              TableScan [TS_0] (rows=7 width=12)
                                default@tu,tu,Tbl:COMPLETE,Col:COMPLETE,Output:["id_uv","id_uw","u"]
                      <-Map 5 [SIMPLE_EDGE] llap
                        SHUFFLE [RS_10]
                          PartitionCols:_col0
                          Select Operator [SEL_5] (rows=1 width=8)
                            Output:["_col0","_col1"]
                            Filter Operator [FIL_28] (rows=1 width=8)
                              predicate:((v > 3) and id_uv is not null)
                              TableScan [TS_3] (rows=4 width=8)
                                default@tv,tv,Tbl:COMPLETE,Col:COMPLETE,Output:["id_uv","v"]

PREHOOK: query: select assert_true_oom(1 > sum(u*v*w)) from tu
        join tv on (tu.id_uv=tv.id_uv)
        join tw on (tu.id_uw=tw.id_uw)
        where w>9 and u>1 and v>3
PREHOOK: type: QUERY
PREHOOK: Input: default@tu
PREHOOK: Input: default@tv
PREHOOK: Input: default@tw
#### A masked pattern was here ####
Status: Failed
Vertex failed, vertexName=Reducer 4, vertexId=vertex_#ID#, diagnostics=[Task failed, taskId=task_#ID#, diagnostics=[TaskAttempt 0 failed, info=[Error: Error while running task ( failure ) : attempt_#ID#_0001_4_05_000000_0:java.lang.RuntimeException: java.lang.OutOfMemoryError: assert_true_oom: assertation failed; Simulated OOM
#### A masked pattern was here ####
], TaskAttempt 1 failed, info=[Error: Error while running task ( failure ) : attempt_#ID#_0001_4_05_000000_1:java.lang.RuntimeException: java.lang.OutOfMemoryError: assert_true_oom: assertation failed; Simulated OOM
#### A masked pattern was here ####
], TaskAttempt 2 failed, info=[Error: Error while running task ( failure ) : attempt_#ID#_0001_4_05_000000_2:java.lang.RuntimeException: java.lang.OutOfMemoryError: assert_true_oom: assertation failed; Simulated OOM
#### A masked pattern was here ####
], TaskAttempt 3 failed, info=[Error: Error while running task ( failure ) : attempt_#ID#_0001_4_05_000000_3:java.lang.RuntimeException: java.lang.OutOfMemoryError: assert_true_oom: assertation failed; Simulated OOM
#### A masked pattern was here ####
]], Vertex did not succeed due to OWN_TASK_FAILURE, failedTasks:1 killedTasks:0, Vertex vertex_#ID# [Reducer 4] killed/failed due to:OWN_TASK_FAILURE]
DAG did not succeed due to VERTEX_FAILURE. failedVertices:1 killedVertices:0
FAILED: Execution Error, return code 2 from org.apache.hadoop.hive.ql.exec.tez.TezTask. Vertex failed, vertexName=Reducer 4, vertexId=vertex_#ID#, diagnostics=[Task failed, taskId=task_#ID#, diagnostics=[TaskAttempt 0 failed, info=[Error: Error while running task ( failure ) : attempt_#ID#_0001_4_05_000000_0:java.lang.RuntimeException: java.lang.OutOfMemoryError: assert_true_oom: assertation failed; Simulated OOM
#### A masked pattern was here ####
], TaskAttempt 1 failed, info=[Error: Error while running task ( failure ) : attempt_#ID#_0001_4_05_000000_1:java.lang.RuntimeException: java.lang.OutOfMemoryError: assert_true_oom: assertation failed; Simulated OOM
#### A masked pattern was here ####
], TaskAttempt 2 failed, info=[Error: Error while running task ( failure ) : attempt_#ID#_0001_4_05_000000_2:java.lang.RuntimeException: java.lang.OutOfMemoryError: assert_true_oom: assertation failed; Simulated OOM
#### A masked pattern was here ####
], TaskAttempt 3 failed, info=[Error: Error while running task ( failure ) : attempt_#ID#_0001_4_05_000000_3:java.lang.RuntimeException: java.lang.OutOfMemoryError: assert_true_oom: assertation failed; Simulated OOM
#### A masked pattern was here ####
]], Vertex did not succeed due to OWN_TASK_FAILURE, failedTasks:1 killedTasks:0, Vertex vertex_#ID# [Reducer 4] killed/failed due to:OWN_TASK_FAILURE]DAG did not succeed due to VERTEX_FAILURE. failedVertices:1 killedVertices:0
PREHOOK: query: select assert_true_oom(2000 > sum(u*v*w)) from tu
        join tv on (tu.id_uv=tv.id_uv)
        join tw on (tu.id_uw=tw.id_uw)
        where w>9 and u>1 and v>3
PREHOOK: type: QUERY
PREHOOK: Input: default@tu
PREHOOK: Input: default@tv
PREHOOK: Input: default@tw
#### A masked pattern was here ####
Stage-1 org.apache.tez.common.counters.DAGCounter  COUNTERS:
   NUM_SUCCEEDED_TASKS: 6
   TOTAL_LAUNCHED_TASKS: 6
   AM_CPU_MILLISECONDS: 1840
   AM_GC_TIME_MILLIS: 149
Stage-1 org.apache.tez.common.counters.FileSystemCounter  COUNTERS:
   FILE_BYTES_READ: 0
   FILE_BYTES_WRITTEN: 0
   FILE_READ_OPS: 0
   FILE_LARGE_READ_OPS: 0
   FILE_WRITE_OPS: 0
Stage-1 org.apache.tez.common.counters.TaskCounter  COUNTERS:
   REDUCE_INPUT_GROUPS: 9
   REDUCE_INPUT_RECORDS: 9
   COMBINE_INPUT_RECORDS: 0
   SPILLED_RECORDS: 18
   NUM_SHUFFLED_INPUTS: 5
   NUM_SKIPPED_INPUTS: 0
   NUM_FAILED_SHUFFLE_INPUTS: 0
   MERGED_MAP_OUTPUTS: 4
   INPUT_RECORDS_PROCESSED: 22
   INPUT_SPLIT_LENGTH_BYTES: 105
   OUTPUT_RECORDS: 10
   OUTPUT_LARGE_RECORDS: 0
   OUTPUT_BYTES: 84
   OUTPUT_BYTES_WITH_OVERHEAD: 134
   OUTPUT_BYTES_PHYSICAL: 178
   ADDITIONAL_SPILLS_BYTES_WRITTEN: 137
   ADDITIONAL_SPILLS_BYTES_READ: 137
   ADDITIONAL_SPILL_COUNT: 0
   SHUFFLE_CHUNK_COUNT: 4
   SHUFFLE_BYTES: 154
   SHUFFLE_BYTES_DECOMPRESSED: 134
   SHUFFLE_BYTES_TO_MEM: 154
   SHUFFLE_BYTES_TO_DISK: 0
   SHUFFLE_BYTES_DISK_DIRECT: 0
   NUM_MEM_TO_DISK_MERGES: 0
   NUM_DISK_TO_DISK_MERGES: 0
   SHUFFLE_PHASE_TIME: 172
   MERGE_PHASE_TIME: 245
   FIRST_EVENT_RECEIVED: 34
   LAST_EVENT_RECEIVED: 34
Stage-1 HIVE  COUNTERS:
   CREATED_FILES: 1
   DESERIALIZE_ERRORS: 0
   RECORDS_IN_Map_1: 7
   RECORDS_IN_Map_5: 10
   RECORDS_IN_Map_6: 4
   RECORDS_OUT_0: 1
   RECORDS_OUT_INTERMEDIATE_Map_1: 6
   RECORDS_OUT_INTERMEDIATE_Map_5: 1
   RECORDS_OUT_INTERMEDIATE_Map_6: 1
   RECORDS_OUT_INTERMEDIATE_Reducer_2: 1
   RECORDS_OUT_INTERMEDIATE_Reducer_3: 1
   RECORDS_OUT_INTERMEDIATE_Reducer_4: 0
   RECORDS_OUT_OPERATOR_FIL_1: 6
   RECORDS_OUT_OPERATOR_FIL_4: 1
   RECORDS_OUT_OPERATOR_FIL_7: 1
   RECORDS_OUT_OPERATOR_FS_21: 1
   RECORDS_OUT_OPERATOR_GBY_17: 1
   RECORDS_OUT_OPERATOR_GBY_19: 1
   RECORDS_OUT_OPERATOR_MAP_0: 0
   RECORDS_OUT_OPERATOR_MERGEJOIN_22: 1
   RECORDS_OUT_OPERATOR_MERGEJOIN_23: 1
   RECORDS_OUT_OPERATOR_RS_10: 1
   RECORDS_OUT_OPERATOR_RS_12: 1
   RECORDS_OUT_OPERATOR_RS_13: 1
   RECORDS_OUT_OPERATOR_RS_18: 1
   RECORDS_OUT_OPERATOR_RS_9: 6
   RECORDS_OUT_OPERATOR_SEL_15: 1
   RECORDS_OUT_OPERATOR_SEL_2: 6
   RECORDS_OUT_OPERATOR_SEL_20: 1
   RECORDS_OUT_OPERATOR_SEL_5: 1
   RECORDS_OUT_OPERATOR_SEL_8: 1
   RECORDS_OUT_OPERATOR_TS_0: 7
   RECORDS_OUT_OPERATOR_TS_3: 10
   RECORDS_OUT_OPERATOR_TS_6: 4
Stage-1 Shuffle Errors  COUNTERS:
   BAD_ID: 0
   CONNECTION: 0
   IO_ERROR: 0
   WRONG_LENGTH: 0
   WRONG_MAP: 0
   WRONG_REDUCE: 0
Stage-1 org.apache.hadoop.hive.ql.exec.tez.HiveInputCounters  COUNTERS:
   GROUPED_INPUT_SPLITS_Map_1: 1
   GROUPED_INPUT_SPLITS_Map_5: 1
   GROUPED_INPUT_SPLITS_Map_6: 1
   INPUT_DIRECTORIES_Map_1: 1
   INPUT_DIRECTORIES_Map_5: 1
   INPUT_DIRECTORIES_Map_6: 1
   INPUT_FILES_Map_1: 1
   INPUT_FILES_Map_5: 1
   INPUT_FILES_Map_6: 1
   RAW_INPUT_SPLITS_Map_1: 1
   RAW_INPUT_SPLITS_Map_5: 1
   RAW_INPUT_SPLITS_Map_6: 1
NULL
PREHOOK: query: select assert_true_oom(1 > sum(u*v*w)) from tu
        join tv on (tu.id_uv=tv.id_uv)
        join tw on (tu.id_uw=tw.id_uw)
        where w>9 and u>1 and v>3
PREHOOK: type: QUERY
PREHOOK: Input: default@tu
PREHOOK: Input: default@tv
PREHOOK: Input: default@tw
#### A masked pattern was here ####
Status: Failed
Vertex failed, vertexName=Reducer 4, vertexId=vertex_#ID#, diagnostics=[Task failed, taskId=task_#ID#, diagnostics=[TaskAttempt 0 failed, info=[Error: Error while running task ( failure ) : attempt_#ID#_0001_6_05_000000_0:java.lang.RuntimeException: java.lang.OutOfMemoryError: assert_true_oom: assertation failed; Simulated OOM
#### A masked pattern was here ####
], TaskAttempt 1 failed, info=[Error: Error while running task ( failure ) : attempt_#ID#_0001_6_05_000000_1:java.lang.RuntimeException: java.lang.OutOfMemoryError: assert_true_oom: assertation failed; Simulated OOM
#### A masked pattern was here ####
], TaskAttempt 2 failed, info=[Error: Error while running task ( failure ) : attempt_#ID#_0001_6_05_000000_2:java.lang.RuntimeException: java.lang.OutOfMemoryError: assert_true_oom: assertation failed; Simulated OOM
#### A masked pattern was here ####
], TaskAttempt 3 failed, info=[Error: Error while running task ( failure ) : attempt_#ID#_0001_6_05_000000_3:java.lang.RuntimeException: java.lang.OutOfMemoryError: assert_true_oom: assertation failed; Simulated OOM
#### A masked pattern was here ####
]], Vertex did not succeed due to OWN_TASK_FAILURE, failedTasks:1 killedTasks:0, Vertex vertex_#ID# [Reducer 4] killed/failed due to:OWN_TASK_FAILURE]
DAG did not succeed due to VERTEX_FAILURE. failedVertices:1 killedVertices:0
FAILED: Execution Error, return code 2 from org.apache.hadoop.hive.ql.exec.tez.TezTask. Vertex failed, vertexName=Reducer 4, vertexId=vertex_#ID#, diagnostics=[Task failed, taskId=task_#ID#, diagnostics=[TaskAttempt 0 failed, info=[Error: Error while running task ( failure ) : attempt_#ID#_0001_6_05_000000_0:java.lang.RuntimeException: java.lang.OutOfMemoryError: assert_true_oom: assertation failed; Simulated OOM
#### A masked pattern was here ####
], TaskAttempt 1 failed, info=[Error: Error while running task ( failure ) : attempt_#ID#_0001_6_05_000000_1:java.lang.RuntimeException: java.lang.OutOfMemoryError: assert_true_oom: assertation failed; Simulated OOM
#### A masked pattern was here ####
], TaskAttempt 2 failed, info=[Error: Error while running task ( failure ) : attempt_#ID#_0001_6_05_000000_2:java.lang.RuntimeException: java.lang.OutOfMemoryError: assert_true_oom: assertation failed; Simulated OOM
#### A masked pattern was here ####
], TaskAttempt 3 failed, info=[Error: Error while running task ( failure ) : attempt_#ID#_0001_6_05_000000_3:java.lang.RuntimeException: java.lang.OutOfMemoryError: assert_true_oom: assertation failed; Simulated OOM
#### A masked pattern was here ####
]], Vertex did not succeed due to OWN_TASK_FAILURE, failedTasks:1 killedTasks:0, Vertex vertex_#ID# [Reducer 4] killed/failed due to:OWN_TASK_FAILURE]DAG did not succeed due to VERTEX_FAILURE. failedVertices:1 killedVertices:0
PREHOOK: query: explain
select assert_true_oom(2000 > sum(u*v*w)) from tu
        join tv on (tu.id_uv=tv.id_uv)
        join tw on (tu.id_uw=tw.id_uw)
        where w>9 and u>1 and v>3
PREHOOK: type: QUERY
Plan optimized by CBO.

Vertex dependency in root stage
Reducer 2 <- Map 1 (SIMPLE_EDGE), Map 5 (SIMPLE_EDGE)
Reducer 3 <- Map 6 (SIMPLE_EDGE), Reducer 2 (SIMPLE_EDGE)
Reducer 4 <- Reducer 3 (CUSTOM_SIMPLE_EDGE)

Stage-0
  Fetch Operator
    limit:-1
    Stage-1
      Reducer 4 llap
      File Output Operator [FS_21]
        Select Operator [SEL_20] (rows=1 width=4)
          Output:["_col0"]
          Group By Operator [GBY_19] (rows=1 width=8)
            Output:["_col0"],aggregations:["sum(VALUE._col0)"]
          <-Reducer 3 [CUSTOM_SIMPLE_EDGE] llap
            PARTITION_ONLY_SHUFFLE [RS_18]
              Group By Operator [GBY_17] (rows=1 width=8)
                Output:["_col0"],aggregations:["sum(_col0)"]
                Select Operator [SEL_15] (rows=1 width=12)
                  Output:["_col0"]
                  Merge Join Operator [MERGEJOIN_23] (rows=1 width=12)
                    Conds:RS_12._col0=RS_13._col0(Inner),Output:["_col2","_col4","_col6"]
                  <-Map 6 [SIMPLE_EDGE] llap
                    SHUFFLE [RS_13]
                      PartitionCols:_col0
                      Select Operator [SEL_8] (rows=1 width=8)
                        Output:["_col0","_col1"]
                        Filter Operator [FIL_7] (rows=1 width=8)
                          predicate:((v > 3) and id_uv is not null)
                          TableScan [TS_6] (rows=10 width=8)
                            default@tv,tv,Tbl:COMPLETE,Col:COMPLETE,Output:["id_uv","v"]
                  <-Reducer 2 [SIMPLE_EDGE] llap
                    SHUFFLE [RS_12]
                      PartitionCols:_col0
                      Merge Join Operator [MERGEJOIN_22] (rows=1 width=12)
                        Conds:RS_9._col1=RS_10._col0(Inner),Output:["_col0","_col2","_col4"]
                      <-Map 1 [SIMPLE_EDGE] llap
                        SHUFFLE [RS_9]
                          PartitionCols:_col1
                          Select Operator [SEL_2] (rows=6 width=12)
                            Output:["_col0","_col1","_col2"]
                            Filter Operator [FIL_1] (rows=6 width=12)
                              predicate:((u > 1) and id_uv is not null and id_uw is not null)
                              TableScan [TS_0] (rows=7 width=12)
                                default@tu,tu,Tbl:COMPLETE,Col:COMPLETE,Output:["id_uv","id_uw","u"]
                      <-Map 5 [SIMPLE_EDGE] llap
                        SHUFFLE [RS_10]
                          PartitionCols:_col0
                          Select Operator [SEL_5] (rows=1 width=8)
                            Output:["_col0","_col1"]
                            Filter Operator [FIL_4] (rows=1 width=8)
                              predicate:((w > 9) and id_uw is not null)
                              TableScan [TS_3] (rows=4 width=8)
                                default@tw,tw,Tbl:COMPLETE,Col:COMPLETE,Output:["id_uw","w"]

